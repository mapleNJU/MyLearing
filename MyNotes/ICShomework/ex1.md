# Chapter 1 Homework

`201300066 麻超`

### Question 7

##### 1.
为了得到峰值MIPS,我们应当选择CPI最少的指令，对于机器M1而言，为全部由A类指令组成的程序，对于机器M2而言，为全部由B类指令组成的程序：

$MIPS(M_1)=\frac{1GHz}{1}=1000MIPS\\MIPS(M_2)=\frac{1.5GHz}{2}=750MIPS$

##### 2.
当五类指令拥有相同指令条数时，可以先计算其CPI，如下：

$CPI(M_1)=\frac{1+2+2+3+4}{5}=2.4\\CPI(M_2)=\frac{2+2+4+5+6}{5} =3.8$
二者时钟频率不同，由于$\frac{2.4}{1} =2.4, \frac{3.8}{1.5} =2.53$

所以$M_1$执行程序P的速度更快，平均每条指令快0.13ns.CPI如上。

### Question 9

程序P在机器M上执行所需的时钟周期数：

$8\times 10^9\times 1.25=1\times 10^{10}$.

所需时间：

$\frac{1\times 10^{10}}{4\times 10^9} =2.5s$.

占用CPU时间百分比:

$\frac{2.5}{4} =62.5\%$.

### Question 10

S1:

* 指令条数：$5+2+2+1=10$
* $CPI:\frac{5\times 1+2\times 2+2\times 3+1\times 4}{10} =1.9$
* 所含时钟周期数：$1.9\times 10=19$
* 执行时间：$\frac{19}{5\times 10^8} =38ns.$

S2:

* 指令条数：$1+1+1+5=8$
* $CPI:\frac{1\times 1+2\times 1+3\times 1+4\times 5}{8} =3.25$
* 所含时钟周期数：$3.25\times 8=26$
* 执行时间：$\frac{26}{5\times 10^8} =52ns.$

### Question 11

$P^{'}$的执行时间为10s，所以多了$1.2\times 10^9\times 2=2.4\times 10^9$个时钟周期。

由于乘法指令CPI为5，左移指令为2，少了3，所以每条左移指令都比乘法指令少用3个时钟周期，于是有：$2.4\times 10^9/3=8\times 10^8$.于是有$8\times 10^8$条乘法指令被换为了左移指令。

### Question 12

分别计算总的时钟周期数和每一条指令的时钟周期数：

* 浮点指令：$500\times 10^6\times 2=1\times 10^9$.
* 整数指令：$4000\times 10^6\times 1=4\times 10^9$.
* 访存指令:$3000\times 10^6\times 4=1.2\times 10^{10}$.
* 分支指令:$1000\times 10^6\times 1=1\times 10^9$.
* 总时钟周期:$1.8\times 10^{10}$.

为了使程序P的执行时间减少一半，对单个指令进行改进，则要求该指令总时钟周期数下降额要到总时钟周期数的一半，即$9\times 10^9$.对于浮点指令来说，总数还不到这么多，所以浮点指令的CPI无论如何改进都无法达到目标。对访存指令来说，其CPI需要改进到$4\times \frac{1.2\times 10^{10}-9\times 10^9}{1.2\times 10^{10}} \times 4=1$.即访存指令的CPI需要改进到1.

下一问：
* 此时浮点指令CPI:1.6,时钟周期$8\times 10^8$.
* 整数指令CPI:0.8,时钟周期$3.2\times 10^9$.
* 访存指令CPI:2.4,时钟周期$7.2\times 10^9$.
* 分支指令CPI:0.6,时钟周期$6\times 10^8$.
* 总时钟周期数:$1.18\times 10^{10}$.

在改进前的运行时间：$t_1=\frac{1.8\times 10^{10}}{2.5GHz}= 7.2s.$

改进后的运行时间：$t_2=\frac{1.18\times 10^{10}}{2.5GHz}= 4.72s.$

故程序P的执行时间会减少$2.48s.$